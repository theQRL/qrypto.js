import { expect } from 'chai';
import { CryptoPublicKeyBytes, CryptoSecretKeyBytes, CryptoBytes } from '../src/const.js';
import { cryptoSign, cryptoSignKeypair, cryptoSignOpen, cryptoSignVerify, cryptoSignSignature } from '../src/sign.js';

const HASHEDSEED = '8078f74eb51029b5b96cfbe2bd0ab8433252bf4c6c8fbad92789add5e3cca216';
const PK =
  'da218daf9d5457bee0e2381250f7ad3159e8a243fbf90e02c2802e1722cee954758875aa00c57adda2736030ea7fd293367c202298d7125f4ca8bd83d0ee8e8805f4a9f2d3915d507a581d59a80491575ed69ed994a6650ecf8902cb056a6d5f8b59a46905ab1c58094c2a5a388de306486dbc23bf268ffa272e010182e8e9e23c07f55a866e59195333a353aeddf3cd51c22f955c21977d3ee9e4ee6557f30edb5d2517c04f834f6825a7a162323cb8b679cb5d2089190aa3e3c486b4b9895987b47e1b475ccc4f25969bc95ac24d2fb3cfcda7330ff9f949ac06a2b7a7293ee8463dc38a9c55d4bb5d8f4904836c29764931b0c3f4d1257871b132b08ae249fb40b61bb75360298f15345d4868b7aa4f06c485b703f6db84d2d5e1e70412928d6c6454a2a019540c518243e18e17404dfd781a576a34e0f297bc4fa69532e717cb9cadc1feafe4c6a99e31cde842dc05fd19d8c7131d530e9ab22b1c621e9d4a2ffd444376f0e0847c0523f56f345669fe88bb28492ed23dc822f83be85eb035695eceb08fb24fab3fb6cd54ee5972d68664af9d3bb4213da1ee11e95070eb45d033777eccf9efe54f2f23bdd0fd64cd0b4bd311d941f108fa13166505944de90e25fe50d4d4be8118d316994b53bacb96c92a4f4048e10fb01d7a8e89d7d0ba37f58ba37e1c399fd1d5c2fd0ba1d30231432a0592d0e06b0a18f0decaa3ef39e88c6d70b42bcc80e28f633c99a89e411d300ff78c7bc93f910906bc9d9202f4ce3b9a1c37432b4df23e053297f81b965ca0b1f447e323a2e66c9ffb75ab1c8daa2a9b239bd87bed1990f4dbf9747005950aa73b6a74da306342a63dfb67d5042f16814f08bd3fda8b572e501ce0a03111f93c0c1d3655634435f1ffc3fc000bf133c926bc336304eea648a7a1c7ebdd65fa593d5c11990878b385499a394584702fe309073aa15420e0d0980165ae7213dae40890babb2bbd3f7abf648c9dc74feba7c0ec8f0525bf5744744b9f5b28f6ac7f234e4f425f4bbafb69714abd911dd0514fd53039c13f72b1074f6c5a229f9172628747079193592bf74ac9049c2aed7823e9522ffeffb7d84887808a5e0814407ebbf514301fb015a3f0fa0c79d3fea883901f3bfc493569a239156f29364a1b43aeb4c3dc6a975ba517e1a6e8ca66b60e4de5326d2d65d95783b050546c73edc37175bf2dac38109c4cc6711c4f6ce4b7af5313e1967161841c11cbbd4f998d5d6b6b1135c9c75616ec88393300c199a2d602f6b048302258c6bf8960434ba6d3d6108a9d8fe17569c1454aedaa7b383975f3ecf1565df1e007744b9474111756a9b4471475dac9e55bb5eb1df67329aa077c14bb8aebac457ad06744e6b67238e1416e14a1c8c84d7981bb42b41562b10b9ba86809f47d19bb2c6a8a9f88559a9a73fecc7f95d781501095fd0f7493ecb020b35b613e2c91db655a9c85ae893e4da69e1ad833fb40c285f09992dbb6b18f154b198af34e3088928102e618722412934ff0bff977d9195d3eb520f8edb7cb08ffc9eeb0f60d02d8272652e456fdd28392acb41ce12fadc83c70dd742abd2015805f2b3713995d1d99050f08f9f88366cf5870b827dadc5bd20fdeacd672df857330be4e1b96838a0d8e97859fd7127d355e51ff9a5e43697b3cedaa1d62dd3aabe28fef97eae5cfec98399bc66f7a34616f95dcebf7eb6563a9115c13c46a80d564e669af08ce600ba0fec9f15a9422b1da6c3995cbff0212626c118ddf77721d84c938200bc9618e7234e3137053eb16620942e9632684e73163f0daad57327999e800c226a09c7083581e3b647cbd61e42a986ecb52f8e64e4d3efdb3fb942ebf2d1638a5c567115e6d33436e2f515e15b903e727d22c1945c968fd1ba1d87093e7768b75cd6033f2826580e85bd7c96477a62b1956a8f7aaba88d7ae095812acc9b9c33a477f3f920e49c7443bba90561b7804f6fe2bba598103507c61365bc11aea34f9f84c0e3a902eb6df4c292aead67699a63c1f5a4b87beb14b2e45537841902764b459b90ba378aadfdcd125deb953413fec2e3e1e3b4f6e435ae84cc7951b996a03db7e49cd1ddeda2041c99eff5dc9c85ffa383852ba9f9dde80cfe8c0353a6faa24a5ae307b8bd863c14f6a9b5b75daf8534118131b3b32b8239f51f6d5123ced24e9bd251d208ca40fa97f9e47fa79f25ede38280a5206c10281a8d4a8459fb0fe9dece2cc61f1ced84e7b5744e59312e32de10c82be7f81264d3a775a04913ce7bb1f28c25037f4b3b2ad5790b3667c9e309234cd161c36f7a71a0145ff0a7c9c1b9bed601b4971696c1979ac3ae2418a842e50c33ed45fddd0e319e48f72583cb90a4b08a57983f63918352cbc6f0a6d345c845f0f2cfbebc25cef454dfcdde04966e63e37d0b2060a12bdedfe3758c5f38a3c7250271ce9dded0e2c37304bbf668add831f76902d42041b9e7a2d77e9e912980be070a0dd84f3523055a86d84b7d92282974ec8f411e26aa88286b6a1314ea9a0b3d3ab100947770238d6a714d0e2ac9a1b7b3cff7e54c33d8bf7a40972418dc7fb205d7c29a8ad0a269eb9f0874e1ae2d37485e9fac92bce8c267d2feaa63f1fe186ae0cd25b626246b2db984941fa6eeb2b2ab14a56aaf15da2458b591b4862173a917a404725b9fee25539b948b2e2c9c5f2a251e9f88cd301715aa221e710228a0e1c691e0ea91414d7ddc6cbe76b572dd904b8107e4472e5e0d694ec8e4cf29c79ca83206c9a8fcb8e77a1157b4f7c9a68ab41520b5e2c0c9af6d11109c259ab5dc8d1f87bc83ebeb4a8845519833e42883ad7b16752b2ffbdc53ececca688b97b431a33d4223dcc32be985ea66f255ae44df027713ae10120e3bcc2eac966d974cc6e69449e959d7eb783855f975d36a8a5d5889db3137b338cabba16284d87965493bb07cc5639bb017499d5a59049a65fd5a0a58568c8c93677491b45b3099dd3ab9527dcb9455d42e7c22278dd800187a8fa016ad0ae3a5737f5ac6fbec043576cf5298150daba87066fb20ee074dfbfb330f4d9321834b35b43e9448997b254e78e1f2c5a4d757e4dc5bfee53dedcc863c539273d7135b063b724bc0edf153fd1f2828866801673c068442b38bcf45ea3bc006b84aaef5e8cc1de1d00e10484b3a59546c4b729595bde6a7facb5e1f6a041dd52307ec9ca2d1ca891eca2e2f0803ddac1698d6cc07d4ee381c06e9d232676c1acfa03287000c44afdf6c1613fa3ae499acd852f8a43dee5f2f790ab6b56a3010d6f35b6d0d3d185540f21593b8d8e75c4938192706ae087555ebc1e48882f1ee46af8256964d7fd4fb9bb6ffa60f79036b17e46d7f210c25fb1690a748dcf33ae74b1f44290fe1a46b87333def13630cc17e7e1290593775b043f817e603675dd16ceb159b4ee6d43799c2ae23984465e0942a64e30da1271d5e6194585d3ecdfe2302d4cae4ca388a516184e333f0d87103ab6585a955be8c7708c338fe1775b04486721b008cf99fd1f6d1a0d1027d975b21086fd42d4037f7979eac9e22108432401aff3443c5aec62e5a7c44bcda3d0ccc0e1b56c611f69b84500d2649f852190eedd1eb9a121d476dd26f81c6a52859c1de36066e8ce44a9f2edf94717b0fe445caddb';
const SK =
  'da218daf9d5457bee0e2381250f7ad3159e8a243fbf90e02c2802e1722cee9540b5e62cb0091be3c87a916e8f74d930b2e2d855068b043512edb1227b8727e035741cda59a36b5b2a7f520f05f99d76d9a34cdd2694c4dc703930a6fbbc1d4022c578982def69df5e8e26aba1f4f05c7717a4e1070ec2b55b865e261f1916d63821440e3804d918065543042a0084ed8146e03895181266c0907092434509230899110908a2620092226a2185003809001002800294c5a9884120589dc0288d40269423460c3a0801ac9444bc60c5b14514bc400ca804523842de326851ab02d4408698b0601a2b68122c98c09b604609865102310e1060650b42d0c174e1c970d63008158402ae0484e03a86dcc18729b2621e0a408d2a630dc20251ab80518c1689002929c46061c808c5c4444a3842418b60104c0094122129992008084252085610215041c8870dc32061cb460e11829cca60001012652226acc1640d0221014a74d1246881c30201b4520143552c31412cc88459340100b0082448288dc042d4c380820173024a07183a6851a435009926082a40882a6858930012220069ab6705c44421401891c3565008244c922100cb52c88040294384a14238e5c929119867140888422054ed332680320421b4826d3280123468da31669e41206c2027104078cc9b2298ac62408364854a4600a470ae0c0000a058e0c43409136645c189108b77040c248d8886148a860130110d440484a3402c1a608d9001100838418254e90940103383062a8290a074019932521171013446048806c0104014bb490e4806004434e14896c913231cb146123478298b88c2406510c952908a881133428a00848224029e0440058b690082588220024923228e308520846101b84050a1745903422e0821119384ae2265259182244280ea3968492448e21116d21168512906c091025d010921ca491122932002844191311cc342450308894142098468c1036524820811b224e0035480bc98583b80d230224cb922c61346a628884e4b49008890019b02960b02d1a32111ba0514496900291094b96299b9670d40480d1122ae0a8040a220243a88484426a001990a49049211129c8885109232c94040d20b62dc0b811cba0490840520033851239489340454216701b1811042380d33089dbc82401380984386621488dc38001e30844091401540672c3863123214cd8c62c9b2642042340933864c1446a0c22241aa824cc007204a969e0902ddb060ec286911204850a131284c00c649851592845db28820c982120c429602002da240e62288e600284648848e41086cb929009448d88126d4904285a24264a3665db309019110250181183824183b03063a669c3a084d80884e39870491200099745e2c02182202a63c400e018851828915b288408c189922472a1202883126589c464cb962d113072e1308ed816420883441882889c104954124a09042404142da49021481044c24604a0c86401a54d82486503c8851c95454c34916026514394891a136c0b06895ac44121398590a48d834609230425d3149142088002b62004324d00a34889162e903068c0345224c0684b1252e108214c422cda386a22134600008cd1386cca90919aa88820450a94a24121268918354e88929120004412866d8118661144668aa891098864093051192288483066114271e1220018b77020876cda4832c926621c1770928451a1408d64048d103880000282c8c4688ca268a2c82821a36911c3095cc0500a99600a08620c36101b47319a3266e1c00d029889c9246c08c6300c108c2208040b37811b27015a02215bb0010a36314c8885c9a48d11a08c8a862124b5042221010c872904094851a60509106acc448a21c391e2b46414c3115ab60862c0641a28824ab081d82262a316082424461c8328198428c2066e03432c20196e0bb765c8a031a316029b14058a228ec34252c2b00561a2491c144441161294242089b49100a86d480262591061d4c044a1a265c4344e11038190322a59a2842240618c4440a09849d1964d44266062088920920c0a1812520866c22470049230242886cc98205b26444b202c18b2619c086a98428c8ac020a49410e292290a09322080701c2522a22632122892d3342e14828903068d1ca45083344880322908336a1ca941c11065c800518928105c042a0b856991e93f35659d3f7b11bbfc3443dd48cb0e3cdc35be09f092124908b0344c0fd5d1595ff2bd9473f854280d2bcd9377d6129f3f105f16d80899dd16d5c452bc002b14cc5304b98099f4f189dc344f3d77bff6e0aa03511969012ec0e857a3d8ab31cf08ed1a48be59bb0f9b2bf9a8a4d4c6a35d45fefd45b7c7f792db793d236f52605ed7a80dd4e8e9696a44c7d5232bbad92c80b54afc61ded07a01645ba70e8f6181d6ad479d2e0db5fc59a46b251243422d03d2048fd1c1cb55c70b03dd55eacb3d96a91ea2941d1aa01ab1552b8b22caa17a83e4bd740b1e998526eabf5bacaf31a0d088c1d0419bd666f4b468c408ef8bad59e61d47d235f1ff7369701a849c59ba9cb79699a66d03c67d650552f5d4bab6e09ad17a4dc5190eeba879ce2d104c34f183119802154b146057e44942af4a107017d9fc057bab642e920a3596cc500fe2e71009a1b6b51c0e55eab2c08ed2c1e05a28046b0024a7e64f7307c1927960fe6dc275db066f617b6c33d6dd295c300e8421563b040921306db9eec5d92a8f426d9d02a9afc4ca4b6b81f28a70af6a06ac275218235395d40310b9b1190171ae17ebfe24127d3761874e5c49817e763b251a07d1dfa3d15d7ec26b52f695cc8023a74cd418c579952a9e0a59cd4712a2171e63027c43def6a3627b154d43177ee2a9f9e63886764c98c0b0705156daf132e41a458cfdf836cfcaf5ed0c6bda497eaffca3b50e83791811d10985e89bf0bafb9b24a94dbdc65a895791eae3a72a6e6ced4799dcedde9e136060fc6a2da86f4d91106847003e621d3f51fdfbda193e44162c3369cf6bc4a0db9cffe70d1fc4b4735fb975c0c1dd200128d9942a03d946570036f2513b9d4745c2a0a0a76b66485528be114a77c146c69f8ae352557ea80518a00e49a153a12bbed470d921dbaf89748f23f9b84ae2e91c705a3a47f70a11420e7d68cbb412fa046f9021ab7f34cab78bc4ab6ce1f88f1791185cd74803ccaec6098406fb3e6b9b4ef390d1e2523cca02c6fe5e71adcd52f65e0e384fff1a404ad09b9b9d9b74e669000440ef5a54dded018fa838ebf075cd3201d225c178a56a2efa5f6438f0a9c0e8e9adca7980943e8824e191f862ec5c3bd7659b3a13978d6ca6ee41440797d451cf6c2c25ff7a6f52bddc35da446b0fc05cc6f664361a5f3feb4509aeb500f6811c6582fc428c4741bde88ae91ccab1eab7e1a18ea7a10b393ea9d84b26621e8b23dd86aa899b408cf3a3dee902d697b91314d8c1ec14319cf9fff43a63b4e832feaaba33363dce8c8a3534b843f4c47a42f29bf275f152a9c0400fa0efa666bc4edee127c0684958b3e050428cd8d4397be14540267916b36ec1325b352a7657693f16219eaf7d0ec05d925c8e5c563f935c16aea2e843ac24c395ecd6e35ce8a8ea61f866d1f2562254a1d782a27ed46ca258b0f7de78a2ed0d5391c5cc35954da52ca7bb85d4dc0bb5d894a7aeda4dc8a0683e49d80fe9831b975871fc19d1fe0394ade47f7d2982a316d08c29cee8a3add11367503ab528fac173987ec411553359f83b61e9659133c7f27471934556ea5d3574b814d811907f9dd25d9b2c3f1ad2aba5ab2cbf7417cd7a41cf249a5205063c52fcc20badfacb9e3202a78edb047709d56448058cd6515f8c0f08e5073a62eca1961f1bdcbb335ab6c333df3ca765f45c5ee5e8717e32626bde1c2bdc40633832efc2eb3ee52bd552a3a1c242da37f55f171766a2f36caa6a8a8c227677bc159a40207bea82f03bbf4a8b9563e94d5506f1a25346c2de761451cbaa2527ad4fa182f11baf7ff9bf5096498dd25587a245e097dd837593a7a2636ac878d136781c265983bbf0740320e98edfb312448bea66b38e087edf2ae13a8bca6798fb94abbdb36360567ab84332ab6ff2b77d9383f6c117d525ba7f3d31a79e101e15fb5a24f243ba7ebebfdcbc27ccb567a3125506f9f6e3254218068d892bbc11d1dc8c23bd5995329f829d02bc1bcff3f934e2104f91eb98b7d0830bfc8399f0992f7aafd0ad2ad1fb472d946406381320412260f90fd6dbb851022330d86cc3c8caa27f70f46e2335cc8775cd028c8d08a3956b44211be8cab10447f7dc7a981370e9d623a03f892ebd7f82a6562facd3a535197f92174328148d5cad8e2ce990167c22e4099b1843a0efeeddc47a190cf991d9d1a8f46a9b9d442a7bfb6c95ce5628626495dda99f1ca937e74f8dd504e6274ee0351157c64ebfb6e072338402aae2cac125cc6938bf1d1b43a04845c64fe8bba7ea16c3273616f0a1666254abfa1c6a47cab4fa53230369d92e301e80e32ef528e9e707202ee034de448a74592834f76ff0429d7bd600f3eea2dcce06e4d10d09eaffa1ed21ec0d2504308d12fa025761794675bd5d75dd7838bbebf974bee0424e968a8b25cf84770660107a0e217e0ecfb97312a04852f68029be7148b3fd42039deb52af700d737df731140832eafdfdc219a4193f804cb2d282807b52d8b2ce05ffeb81861b7433ea643413b4c50ca7858824e00b0ab87d22e9f1e8ee84948fb4443f85d7376859cc20ff2e5a6e9acf11002b868acd3e6464199950ba254093c83983a5aeebd1490a375785a2abb0372f7c9f27b7f66d28cc0c8fc3019f87106f7ff9ddf6d66e3e4ffa872ad4c59837b5837f13e13fdbe1d99612c6a0e016a8567777611a28f694906a0f4c01615fb3ce99788fb529fbf7dc7bd0afefb4c6281ca9af635e7271d9a2c0a77c108b292a05d805ab7b557c77329937a7794eaeb5fd23164decfe33d2a7edd1c00998f168e3a33c8d59dc1bf311ce3a7874e9a1177639dcabd8c98591402fe14e0d29a4b74018b5d7e1498262d6877913df8990e88ada6352a3671d94d54298bdde3ca8992a76113c321812c2526de321c55ae2bb6f7c42868a106a9266dacb4aae9ea925500e876b6f061ea76161d464f88d208c4843aaed1934539c593e0e7318f92f34a9b4d6636e79086f13c5b298004f9077e71b8e159592867d0cd474bdefc595806e6715be347ceaf4a05b8213fae23677f46f697f076a07080f066c6efd5cbd381d5c414fa0225785e50157ffbe93f404458738d33b29f8f798444ba95d0f23e5533bf9097beea2fa4da6fcee69c1b7047327533b46dbdc2622d008f02cf46a2c7368d0ecb1efddfd31e8d3e4f06a420afbe309675c27a8a9d3c47c4ec7827909f770d257b80bcd65db5476282bc1cf555cd0c03905f6f7d6fef2c300d465f20601e96db6b21fc11cec51786a5d0540cad5f94fe6770a4858abd7522effcd0ad1578a9289dfb51427b404eaad1dba801fb3f9da7a5fe86d1f4bb586b8a07ec89b1995d74275dcafca5cfba11492fd1843fa46661645c76fefed8b804981931619c82bef217c70713cc3e21ef97ead5fafe951bbd15d0d91ba81b49bb82cf0acef3b3d6c9a9b00c01d8fccbd253e71baec8d272193846e4be0520bba660582dde0954847e97d8f747d24ef50551c1b4346826f0739be9cb1547600b09e170149ff67536bc55f96abdcd8ec2491d0f8d9154e8431cf6c06855e09ce311582eb78271e4854e0c5b98c9faaded452d7a55b94803cb6a8d5b571f7e6e118312f6d9cdd2bb09d1930e0a1b608a06c7ad5a0bda41c6ddbeac54421c8a4383b7f684bb0c74faedddb6100c1a9b3b19a5645d46e6570da70135c383f19acb7f56b25c2bbfc23a0f00739598d0c00b1edb912275fab346e1ef99ed61201851a5cbb062f3836b26852612ad38dd855911835b73f79ca991727e2589935c98f24d14ca59f1317de7938e4eade460e9bbf51bf5bf26d148bc4b6ad709aff2f63adf93acf77e84b1eca57b748ad0f2952eb99efec9a9536539b880f8140103a1b360a95767652a27787e9e8f9cf8c3e2b7912c7ff9dc772b3e3b3919bf30cf8d626e7fa3d1986bf364fccfac98b337437dcdd6841339a71a6b1ddfd5c5cd59e6ed3848bcdcce7a63cf4df936aa39be758b7c98b36724a012010ef2d3b71a34007494b83eefa94bd26e7d21e6b6378a56dd0dfb6837f20acee1965723db0490a3ac55375d45fcfe119d9ec4a55a507f145189ec3ba2b4181dfcda83d7bef3100dd826f1d89df0391a65f4a79f18fa6c75de83502de768499473e8ba908239e17e31da44fa5679b7a82305c0d5de676cb1242029575613358ce7c723feea343c8888275c018819dd10411243e9f8dd271fd3a9772a3ce1b2fd4c39e4522c8f692a25aaa7da5b05c5fd790ba6a2fa1d154d7bee699d57663990cddfc950c4b713f50a6ac8e7849678caffbf5c90be00d984097358e68d2e32838f7e8e66ab2257616777f080abd5db88a4ecc945a5ab3e5e4c28a49dfa4a8a0e771d15b3551d6fc41ea0e0536d2f590010fecfb25be4110054037073a3efffc749c7af845d85ccab8babd4a0b539907e1624ed69e7cf1fb9456d3b1c4a4be57727e02206cca30ad7cb62801912c147d600e9b48954d9cd2402fbccc4719da7ae98cccfc0b8e2e31bdc7a0fb5b43e63572835bf0f9d1d2da954e4716a70d147dfdcf61241e6831c5b99854e970bf692a2429b9c977c6f5247bd0ee175a2b53d6ce2aa0320291353ee3092507f1f4757c37489d845ad922562f4111dcd680c58ed4a6eb77957daa96dfdc95077815e4ad40ee130768222c9ba6df0c9f5ea3693994061040e9';
const MESSAGE = '00010204060901';
const SIGNATURE =
  'f72e71df3610b365e5e647e75f2bc67e39bfd49f1cb8d479ccf5bd06412b1117c786924b9b0b524ca445dea173039586f46706783eb06d03d262a72e2ead0cf96d0cb70e2520add65a43bdbc9589225cbd125768e4ae2631eb56c8856c26aa5000021ebd81f3a700ab2c9c496736664ce053efd9643cab93adfc5bc22c91f09ea28402aaf1cd7db4919af957936058832b770faac4f8748570ab8dda5c2f387424d1f3a9d5971f1f1951061537157d82f4276e42959090410ba1a85d12d9fe57b4fa6e8b9761181c677c950a3c75e33d879d76fe734606e7d9af733abc02f36ff6c16d659d58dac91450e8419adc2c21e66fb2c5fd34859094cc7d2f695e26355616b552fd922157d83e82a88923e587ead718bec86c3f018123650ee6c25696f70190539750d9a71ca31d90a848421baaa977c09b0d9eb6d841e22173289f8aeb333eac0c5769dc6068d393e1ff5513665727496fa6efd13ef40854a626f7e9bac11e3d563fb612513761b5267bb2bda1231f35a8d81b8b79a15851cb8d9d346ae14137d0269d1f37b809666c5e9aec9f209641408cd652bcadeb54b5405116d50d9841dd9f5b819c83e60a994ad0fdb6b3630b0177077c7d3276283086a4da03ca59a0efa92ee2dcbc917e681a2e1538b5c6faa06c67c27a2cb07b1d424f22b7812123a9fc5894ddb5b7a94722d0fdfe89c830a3d4a0bee10dbc303605af69de29b4c45b8ce2b7ef936d9152af186c591b2d5dfdbf90d7e7a1cc42f45f865a1b2052c919b8115f0babb064198ca7a6efc975bc5385bb547b99fb69c36c42ce37dff14405841187314fd1fbe1d4ae5499f349f66011a73b8bc6fdbb0a9fa805677c629d98106d10a03f6d3025559a2db7281eda014cad3953377d7da2a25cffdcc2c13e85fc26d725118fe3f83790e795e231fbc6aabfbd882693a4d33c9d4173679097866185d14b595d699fd5e90f84289f01aab172167bb5ad1b258225ad9e6b1e6fd9cdcec32af59a0fdd65da8e5093e3295a0210b61064d5fb48d907770e9288301e0f53669699a7551cfda4e07f63b93d5b12ceecc7c3620ddd2533c4444f988ec02a817ed18e10ea023d708016714482d0a48d6b5dc4ee0b85a27f9c6df2966a98ebd75c9edd6b30ee98aecce977ee80d1657f7c2648cfd4bdd82a4a01c2097990d8c2b87dde3c8529a4dbd7dba1b7afdca86b45e505540991b96bc701214c0a81995d5c45cd6f9408a5f9d418ce54390c5960aaa58cb9d9be6bd1e437c9a19b85ddc67f5528d421952b08ce79b15406eb06d0ffc8cb3835f7aa417b823b1332d0dfff8d47f6ac742f42287cb956122bf64e54fb7bc03fec2592644e5248823aa21279ba0ecc32a1f47afb746bd136c51a8dbe945ae201410c41b1a282a5e3f48d942ecac0dd5250e439fa9c12f718c6f7f92e792b335b2730de41fe24284e385cf3a5d2ba7717d15babee6e3b99d38618ad668167b3d08c742a755b4bf95f1128ec7dfdaa6b096e54f9d651de564e0b40fc5c8cc76fa049b06dabe00fab7dd61bd421ec73ac2cfa33d9e510f372c5d486687160e92f712603be64cd59044a11b6d0b53db399ed310a3bda86fa18e88e9a5a7ba90439ba835ffbd424782292ccb806601efd44667ea7feb8f6674e9605b0bc2fa86a5e5380ab6bcd147f175c44ffb65d734c83fd38f0668fb2ec6fa89233a2d79b14f73d14451f67512d27fc0bbb70f8a8d51f24ba4d83e8071747854cd62eb74422101e984a732d7ba5fea1c30e9f3d4fb81f961d4c90511656e5f647dcbd52559ea4bf2a57056ded53c3d3e740a625c6b5a1fc8b9c694666327f8af6148440418b3a6f4eb32e7482348d955fcb6a9871c3a92a8bcacb4e926d39184b91a273d5b629aa240f6c91ccc3219e587e17faf2fcf23cd4652bd57504e406ec95b4bdd18e6d79f0e9e38e69c4c167141ac720b850133bfcd9e0cd77d64842da24c0df219692284926cd99b6d5863ed4ce9cc43e4cf6c7ca39a3190a2a4cbd0e5fc593362d09be9746f0d36ae08cfd82e9ede3006463bf7d84ef82f170dc7de708c164f2784da2d7a957d0d09d445025329135f57e8c051bb29921ebbbb78c196067eec8f6f06dee352ce5f0eb77d6ada8124f4ba07b2af34af1d2850ce02bc909cbe37fa4adeb1951d914d1931b541d51aed1aadca5d9a4cda7a8390364051617b1f3df2bdfed297069606805fd7d4255b331be350163add1e0faa43eb05f35aafeb0442e57e33b418bf74d5fb88c4b018e91cb45558e651fd957a2d1324c8eb0cd994ac0006769756a05a393dc8480641da2244bb52fc8f467acf7918f4c10ff0df6a2682248fb504508137426b681f30e42de6cea0e4f3a0fc27f2567726eae2708a9828088af7d299127f2c76441845bafdf26813fc8a1bded1c87adef5b7858924bb1afe46c055a4532f8ab6674a6eecfe94ccf33902704fb238450b80ac25c116bc98a94c1a6ee295fef188bc076f77c7808f53bc56ae02aafc3fe6225d520318626b89eb7a9b08819cb6e5e076344016d3adcb231ad39b8a8cc2f9472a7abc7a6a690ea0ecc9c86a27d6dc868e33b7f71a7daaee29e6115a8a2916b5f0e5ab09fdf055282f979352545675efc6d65b2d5fa27bd8d83099829f30dc4d9eb44e32e43adadb434dae357f8fed3353df9019d75216e3769a140bd689f0b8a4fdbcf5f4ac19f3e786826e47f70a494a5e35963d7285e7d3d17aca0ba421beebb12f11f1eedb670d2fe047d92729b51f22c6e1c2794bf29038bbdd4f92841d0c90346450c6fd17b586b138296309eb78ab3fac01c6ce3a0267e62cad1ca003256890c0365d7f7f71f0e078ad1c5876e364b757e1ca71c5d86c6dbd18408b6ff1bdb379a55af1e2438fcdc197687148ad704859353d0a7de2fef9d55b0dabe027bb5ea0b20aaa68900a4484af059d8207ab2c3575a7acda1b1ecf95c253c28f9e553d84622bae5a0c276926841530fd6cf411f3fe84f4b9a8d46cc7eab1356961136f40043e284941c7dbf117f037549b3d474b104453aa13806ece3b543374273b7e890fde811011e0048d3765bc95b0f36822c4bfeb7c4385ab051124b8665858d5e32dce716c97c125babdbe853ea57cf929dda12069e92710f4657fa605f90b03ec00752b34c42e35c23a892857affac537da17165e586ff32290b02844570032bb884297e04e74e474004c96822ab02105dafc02ddb198b2357d5285c2f4808a882a31adb45f4b4120a34542b3c3aad41899fc54a6848c37d8959e2cc15eec8b1d442de6f270de7a5d8f810742b5f1740096e2ecee932d2ca88dfe222e8d3978616a7405ec0bca99e4ae345655068cf0bf7253e9cdf19cbd89749b349fb2661a6de932f72cdcbd715d3b6f6fdeaa9100196e80a8f14428dd14691f6d22adeeedaa43046497f5cc8c800849c489aa08ecf8759773a251abce5bb9f59813ab8f33dbcebb6aa61eaf4b1af82a5dc60a5bf6e86f5995083d952b67bb61799d99c1eb51f43a07e1e48e73be01b054b912dc6ac5debfeb77fec32e9c02f56ee19e8493f272db5a071a36f46bc2a9e89a40d814c817c8d52436abda20ee48226d9aaf78b007c6745b8844b3832f97f5a83dde7cae340e45fecab58bb998d11ede9df9776cff8495ab53f058fa5ff63d7ed79bb6678146bba85a0334a9a7d32a4547265315bbc7c3ae049f3354d0f8e624c1efd57c8e00d19982f4455de07417ad84de0ae8af52c7f1664af155d013aea4d9d9db9b645b770e43609be1a1bb1f637ba89b7c2e20cb9ac9c24504d3c1c280df1f27e1bd7838f3845b9810eef9fd54ef0eb25fcc1b0723619f9abfdc433205ee355153a899ae9760a2d7c7945ac037062eb7771e01cf5adb2f088eae6f25446d5976bac5302dded9e605546a2a7f4aeec8317fb733f2fe52f1cd01d2243955dc1628e8458d2d81cd1b9779a745d9503e0b2db8d10bf32fec064da1326ed9b9c4497eeeecaa2b9e8005530cdb1698d941578f6711760812b423712d75060026b503d0a7885c70ea309f9e467fdd6df230b6d86928d8f839483bb570552c748eb80bec5ee96736d74abae49900a25e0df55705d7932f7836da3aba26a2d73213f57db1774a2368f43ef00db93c8a079f740164bf4ba6fa5602da106f85e61421a844a54c858bf88fb3b1c18337fc2500f401659f163e31b5b84fd3ed6f0f7c30da9fd0feab91e3d030b201cb309be7c91e744b96d1ec9015591d4630e5358c19aba581b9e2c3c2feac42ad75fcd47ea595662d31d5db8a8dd8b369cb6b2f7512f45ac28bcd87955adc23cdd3d2df26a74bd2fe1022a5a99b34053697bf6dff96dae7927bdc63f53a52c36e459cf2811651e3a2113afe7f80e8dddaa28ecc2dcad2c66e3f472974bf6ef103dae716e034d79bd3267e42c965c8b85d9921a1201384df64a6050531ddbca49d2723e62a5470320040c306801679591a26fb506d9914163a18cde7fcc73a286d8bd50f1c095729c7e06e6a22a18322f784d10f949867f876401c956a3a296eb1a7c1209a7511511462b5f56fcc8564e56f07eed5cccd8807d31107f59504f80d1921fd243b384a5f51df44245bd2a5ad083de14e35bf05f7f8ebe70700c18b3273bf110b99ced400bd8526d31ab90b1a6e89454b440bf40fa3b96fa797d4b6e0a5424e8161dd5a60001de82fb48a953eb3796522cd9f161867c6757d2d1f82151f54529b41a52c73877569b88587e964ec4054f3596c3a1ecf67eb3b5dad6633b3388bab4fdf34ffe805a489470e32d76803ea75441d244dc77b0e3e99d30f2857a3d95a7f8b3f4fc71990e8309ed12aeb9405c66cbbbbd85fdbda25523044d743d9a4ad0b1f0ae3b815fab8a0edf0458402dac3cca3dac577076a14cc1e936667dd98c487236e60c3c1848d30adf10bd096665d34574fc80d988a7e4e2465ffe493d4e33c22a40cd172f8830dd981e9b06fe6541a00bb41571f1533734e6030e428ef9117989c55028e44f951fb098906d333283e6a95bac5d712ca6044492cf41457838ad50050a1afa15e8b9cb547c83c25c327ef950a596a56574dd72912969bd689f7a3f2dd88d44dd85740d1c200447b98875a5beb21564af29017c15ae04947439f7ee645c013875ccd0c222c31994a82d069630e78440fbaacb66e30c66632fa0b5f150c9c8227e7cd3883e4867f67b29a094f3a0368df5a65e601851bef4490a98adab807e411c7ba90e875192a096f133ddfe7e27efd7eba769b26326756b0cafe3d8c3cbe7f8c5a5847d50f8a81333b7749b0688a8a4bd28d897a548e5238d52b4244962a453452ce7d52e9708318ca3b41d36662d4af613407fae3cd4ed95c57384e341dd75b057e4e710e556771783a12af471032431d16856572c3d5f9c918c53c681f671e95c3ffb2af9f3152b4b17417aff8279a876d560d514ff43b3d58af7bcfee716175653b8abcc1066b85ee55172a44a852094a0d327c584a5e33e1c98416b15a1fa2811abc8f6f72e3f4cb5818a008788887b6debe40acbde233eaa40c07b52b707e1f927c6e8ad18af2408bcb1d47f6aebd94d668241d218b1ebda6b6e202d4b6698832d417319bcb15a309e1a034a3bfc11593bc5a5efa7faf011cab93e5dc09fe75dc2eed6242833aee309fdd37ff1ba40c563be5623e2941fbee4c76ad5608d8b2febaa206e43ae3a429e8754554d10b3d68219b1a14af901bdc8ad2e153cca84bf6cf73c9d5d507ed54f069d953085e229127801c0c97e7711de83ab24c8988f6d09c3bf41845f6d2e4bbe7fc9d041acee5987011ee93f81008d2ad69487d63ce3e9ea43aa264c48061cb41ce129da9a0267a58c21e1dbdef1357d4f5ae0a83372fb9b73bb1582a463f0845e59be1b0a3381485af714e511e1b01b0120addac1802e71b12aa8070038b5a02daf3934ea322d0b2e68f59b2c791226933fe625e9b5e7eecf374fe93cda91a6b2e7c60b69ccc1fdc36ba365f34e3a1afd6e6edb8f60c5b7548371764443a8acc508e54cd698902947f620b1315dce6f89fbb8b7bbec2af7a3c62b0b6b9494864c3a948d87b2f49210ac85564be83aa27eeefc7fbc0efd8b38c3560dedeabf315b17aff022ca1c5fc60ae4ae0db5f24ab6e239e2d5269aa0ceac8723aee7d4938a79055cf4a8c0f76999043152eb8ba6dbea3d87a18d557d382bd1a3fc6c42ac3485ed88547ba9112dcdf2569b223ce0fa01ebe864b0f44fa3a73ecf5453884a5ecb0ba25ab1a8e5f4b74bce7ce65fc8b6736d7036a88c1ab5f6ff10241b9bb36b3d53b566a168f730c604cacf29c2d3f5c8ac71abf8c525659fb168e2bfb6b74dd06cff4b5ee7122198c5585d8851bdb4a4540c4dafe17adc19486d8c99dddeed1b303f7aa6bec2d7f913143046688487adb0fe6f83a6b5cccdd3d7f2f599b7e9ee0113154d75979ca18186020337859199a4e30000000000000000000000000000000008111b252931333b';

describe('cryptoSignKeypair', () => {
  it('should generate the expected pk and sk', () => {
    const pk = new Uint8Array(CryptoPublicKeyBytes);
    const sk = new Uint8Array(CryptoSecretKeyBytes);

    cryptoSignKeypair(Buffer.from(HASHEDSEED, 'hex'), pk, sk);
    expect(Buffer.from(pk, 'binary').toString('hex')).to.equal(PK);
    expect(Buffer.from(sk, 'binary').toString('hex')).to.equal(SK);
  });
});

describe('cryptoSignKeypair with null seed generates pk/sk', () => {
  it('should generate the expected pk and sk', () => {
    const pk = new Uint8Array(CryptoPublicKeyBytes);
    const sk = new Uint8Array(CryptoSecretKeyBytes);
    cryptoSignKeypair(null, pk, sk);
    expect(pk.length).to.equal(CryptoPublicKeyBytes);
    expect(sk.length).to.equal(CryptoSecretKeyBytes);
  });
});

describe('cryptoSign', () => {
  it('should return the expected signature message', () => {
    const msg = Buffer.from(MESSAGE, 'hex');
    const sk = Buffer.from(SK, 'hex');

    const sigMessage = cryptoSign(msg, sk, false);

    expect(Buffer.from(sigMessage, 'binary').toString('hex')).to.equal(SIGNATURE + MESSAGE);
  });
});

describe('cryptoSignOpen', () => {
  it('should return the expected message', () => {
    const sigMessage = Buffer.from(SIGNATURE + MESSAGE, 'hex');
    const pk = Buffer.from(PK, 'hex');

    const openedMessage = cryptoSignOpen(sigMessage, pk);
    expect(Buffer.from(openedMessage, 'binary').toString('hex')).to.equal(MESSAGE);
  });
});

describe('cryptoSignVerify', () => {
  it('should return true', () => {
    const sig = Buffer.from(SIGNATURE, 'hex');
    const msg = Buffer.from(MESSAGE, 'hex');
    const pk = Buffer.from(PK, 'hex');

    expect(cryptoSignVerify(sig, msg, pk)).to.equal(true);
  });
});

describe('cryptoSignSignature', () => {
  it('should throw on invalid sk length', () => {
    const sk = Buffer.from('00', 'hex');
    const msg = Buffer.from(MESSAGE, 'hex');
    const sig = Buffer.alloc(CryptoBytes);

    expect(() => {
      cryptoSignSignature(sig, msg, sk, false);
    }).to.throw('invalid sk length');
  });
});

describe('signingErrors', () => {
  it('should throw an error if the pk or sk is null', () => {
    const pkBad = null;
    const skBad = null;
    const pk = new Uint8Array(CryptoPublicKeyBytes);
    const sk = new Uint8Array(CryptoSecretKeyBytes);
    expect(() => {
      cryptoSignKeypair(Buffer.from(HASHEDSEED, 'hex'), pkBad, sk);
    }).to.throw('pk/sk cannot be null');
    expect(() => {
      cryptoSignKeypair(Buffer.from(HASHEDSEED, 'hex'), pk, skBad);
    }).to.throw('pk/sk cannot be null');
    expect(() => {
      cryptoSignKeypair(Buffer.from(HASHEDSEED, 'hex'), pkBad, skBad);
    }).to.throw('pk/sk cannot be null');
  });
  it('should throw an error if the pk or sk had an invalid length', () => {
    const pkBad = new Uint8Array(12);
    const skBad = new Uint8Array(12);
    const pk = new Uint8Array(CryptoPublicKeyBytes);
    const sk = new Uint8Array(CryptoSecretKeyBytes);
    expect(() => {
      cryptoSignKeypair(Buffer.from(HASHEDSEED, 'hex'), pkBad, sk);
    }).to.throw('invalid pk length 12');
    expect(() => {
      cryptoSignKeypair(Buffer.from(HASHEDSEED, 'hex'), pk, skBad);
    }).to.throw('invalid sk length 12');
    expect(() => {
      cryptoSignKeypair(Buffer.from(HASHEDSEED, 'hex'), pkBad, skBad);
    }).to.throw('invalid pk length 12');
  });
});
