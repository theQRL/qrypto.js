import { expect } from 'chai';
// import { CryptoPublicKeyBytes, CryptoSecretKeyBytes,  CryptoBytes } from '../src/const.js';
import { cryptoSign /*, cryptoSignKeypair, cryptoSignOpen, cryptoSignVerify, cryptoSignSignature*/ } from '../src/sign.js';

// Test vector taken from https://github.com/theQRL/go-qrllib/blob/main/wallet/ml_dsa_87/wallet_test.go#L25
// const HASHEDSEED = '0133968a0085e3ecf0d21e0213e64c37974a0dc1fc74a073049f23a4efec04bf';
// const PK =
//   '6c5c0256b7e67cb7e89b75395082c19cf08a31bdb0cddaa0dbf9099951f1eaba6b78effac950c20e2f10a07e53303e56ca0228685effffd57eb45677935753560cc2301fcf56c73a80684609704b96a50bb25921492b1fd20ee2dc796d4a9f0c6d1b21875c28081e722470236636ab762f8f7b3451f1c5d1865cd6bc75f9e063a93921f4c263413956931d4e4b951bf0c0915f130f32e9334efdb6df5e761a981e0be8708c07d4948643f85862adecad1008ddd0fd166e7933230d8683944959d99f22b61c59542e90caa92c43a1dabda2259029fa798d2aa4226af07ebf1de625603d173833064141bafeb367f2a5df2c177f229dacc119c5a94649a897a01289d4e0d4ace80868153c96fcdb03b4f3c8aa8fdd6b8ab74366322454e400fd2301e30912f6dccaae2647bba0f4b2e893c50f24ac81fb2b9f2fd6ccb8f4e6e1438054dc0284650ba99320654140da53bc57b927bdea089557661056290d826c547483839f8ab77467d959ea0a4bdcbd955b96e27e1d775ce35550f5dfcd8c4347609b75f8fc9746ceecd2da06f36803988a9bf902ccb27c1602333cdb9ff2e4409a7993fc5b54d5d57d1de56564e0885f1d71ee7144df744b0960f753d973d832cc1b7b761282a366abc3a42866b26b8c84518fa05d6a152f017e9bcb466575a470db29f5d7451ff3ae88ff706e9b71e2da68b4eafb82cda58b7ca208685e4c4caeab1ba4a79622e85c08826effe2224f2f16bde95b6a7cccde9b469e9b991e4ea8fc3f1eb54a8fa719af71d321d7b893e3751173f9ef2c48200695f1e29b17597dd5450dd43b3a04042c38f2c602c88ffa4e3e96f1611a43ff6c6734b63f685a9818c9354b900c2d2474afae0728e69e0ba93a9d8c782011fb51e7c6728fb940fef69701a9b32e8527c0a47f8a70f896f5700219215e78cd776ef5079fb6ed9caf20f93c50e20a6e3e7bff8c9b7bbd800e1e59139a3ab3aa5d4018dcbc7095b0d017b77185cc5400693992b1ce633b8d0406b3ba97573108cff5a897b06992bd6385ab5f3537f20d607788d4f0f956103506a0337295915fbe02851b9fcf32e8013a9b433c3250f072571b148436c898e6e78bed671c37fc467491254f68debe627b114c5cffeb1935312fe5abeb4ed22771a35f4aae9b64399908d4be447566e4bddb5ebf2b3837a9b99a7dc59cadba535a77814a43000464cb35a2998688fb2ad2eb66ed367807c9d92e9d776ad2895fdaf12d37cd8c61ff46d027d9adfc0316ec5f3b52f80af2614b18f1d7bdbbda4dc35ba5363d960399042efc1a1fd41f860ed1422ee84e73dc12f1f2eb895d59660c11b1edb72509e5b2212716b055fe52e5a58c3e9b5d22c6d9dc4ca2a1f205d65bc4f9f24f44c72cf42d9b8b91c65858332bb24324b47877aafa523f880cd4724ff990cd2b079105071df7ee90692f43ce23e71a8bc0745984e652b65e6013385e81d44563491f546b0064e9cfb7643da4393cf6b3a7afd4fec232016700c65a8531a88e213a9ab5546255528fc0ac9992c46c1f2ac3192adc32423dbe052dbe33e46aa6d369717c74da5a8eea8e8e281b1f37c8352d2879e4ca9b8e3e0ea3454744ba8bec5434cd3ade1c783085a3dfeaeb90703cca8d0b9fcd9ea063b2ae88ded6b84f9a1498252483a5c7583756631da66bf81ec480478204731baff7f2f2e8cd6ee8a2a76d1dbaed7a8254eb002cc18fd65b57f7982176242e546fda668458378e52eb25ccf149ca097381a878643a34c811d4391474d5d09f5d4317815fc02095cda18372d72ed60d35b70c6554bb91dd8ea4a948ffbeb1bbb130b1109cf4d1702070bb8c9572674fc1df859d9aac67a541af321aa518b1d0de130621141f6be4ffc9226afff782cd2ebb9b1f87162cb32c7df2ee2931a55dff603dda6f81bc1858ab48044c1e6c45c3740c8386d8c357ec0d9dc0ff9ddd7f38ebab0e9f6e6d0f23c944a059109d332e35d2b786fde3df1975b761cef5d52df5f837315c1218d9003ea916f3dd98f926eec8781dd92e726752095e2388cac1a3c8b41da90af4942f8e734105d3b8cba0f310dd38267d2d53e0aa00780efcebbc267ff9bebc980918bdd1b4f42655d0671de9b762ea98ec55fd5d07bb102aeec85903f6653f47ee4951213170bbdcf35a276e0fc4a10df4077b14e9c326890fc502dd5422fc601ad76d45e2ac2f9cdcf1802b4fd2f54af989b0c4087feb032dda3fac5b292af1fbe53013acf162d0a7cfd908d7be37d78904161a04e6f67a63350936ba9d0a94b9400777a3cf2e5c78fc9ea4d0b2de1bd80bed2f0b2201d78a45f37099f912da6698f6bc1eb5a98bf11bd7f3a06fe95a7211a52410913d5ba04d1f80ae24fc499d380980b324ea617def1fd7b90e15df83cd0233f9cbf603aeb41f8f2f3d796596edbca55d385e2620542ecf4fddcee771a69642e7c7bbd2b20acf2774f3e9b0e9adae01ddb5925350b9977ea53071b0db3306dd6dd7c667225d540595013398205381501203bb05bf7c44738936014e1ad5214e2f26059d11f986bdc234f9da8860548e1ede1ca0bf87a010b503f2346610137bc7df2295bb5de4d38c5dc73a7738294232cae9effb82e5a7f012f7b15e223925fb9a1b998545efc28b76a2d9361d545d603cbcc019f70ff073d16c5e2727f123d95eb42339ebac494ce7f28555aea065e6161486fde260a02024f15af6592892934e9fab09025c0ac606e0491e965b58d1dcf60058059e4726728e037a698cf74bf2f2f0f4f9bec51cbc035f32eb3e617cb892af5406e6f3ee74e177a1bb07d1d3b5f80cba842d6d2e7eeb5b2ad7bedb0d9f5e6255033b1bc187064b19b72a2eb926961be1441426200ce27893e30cc217e0a8a9c33fdc22e7c94b49ef094443fca1e528035ec04c83f187686d22862ffcd9edf223d2d1d86da65a597f9f1b784395541bb5d960c1bbc34d0c15404182b3746f875b06bd5f4d41ccb58ed03de6df566cb85595b21ce3bd7062a515bc365c925965e8800263731618f70258a731e41eb45a7d8e19cf18ee8ff0eabb0dd7c89e0f6aacce42dfeee14704d53105f81b627fdb6399c23d330d8ed169e4a76c3d4158016afafdade3b725bfbfcdd8457eef2a8f8566908da236e3a0b35486e0cc979bdcef27329d354624f346a308470d813b28d204b7fab4613243b37ccf92b347390d1da0bf902cd4803a9aa54fd46fc85ff63cae54ce45785aff19cf6b1cf7ada4f3fdaeafc8989e7c9221efc0d5048c6b873bb9951729f92aa097393726a1e904460eb6344a7f4c8d680c0bafdd2f80ac559d82b4970153b87fb7724ac9c92a8dd35c8ebaff1f3d99202d8456d3ed4fa8728f1d4901c883e7cb26dbf804871e4170b6e274c1514d5a64b3c8f4bc70ee41bd0bbc44c1ae016e9bcdf6e71158d37623cf40a64cdf9fb4c230ca8680cd74d49de200acb00ea38117dd8cb246d421b29c355de0cee7b0de003e3c55821a067d8b0b5f8b01a4e5634e48131578a89870e059fb4794d45ba0713179a545a2ffa43d92f178dcf7c6f05c80aca3a6b16419f8d9f6d118caaa5a59535b3211b8ab651de3444ff1205c38df1f7d6b6bf96e04a7d2141a248e0b39619f3da001c437ea752d9c1605d4c11950ffeef401dd3608f368b4e365e9';
const SK =
  '6c5c0256b7e67cb7e89b75395082c19cf08a31bdb0cddaa0dbf9099951f1eaba609726e47be0f4fed3e5f6215375c755e496237b0d3b7ab21b97e4c34f024084d8787332cc930d305a4903b76eeb6b15743d2d80540594c210772c5c48437cd695980e4f5d0cb6bbe40dee6e65f165e0ed3076500482bf9b2daf78762b6aaf8b12b8702421899a2890a0185200236e10c445dc28280b812d62185223240412158809230944a8118912265a48442223441013462417505116505aa20110303223b11043243219402001860d4c4848d90684da142d63204080220a191489532666138664033265caa688144312a43605db122a1239400b1705019364d2c4010b37451c1609e38690ccc8641c354402190e0429854a4466081702c208701042701c456620844809c11193126652468904b74812070559b8118a4492c0160199260593141118112820238888b08d53846d1347258a8071dac28514868dc0900d1b27884b408600a6088912495c326091c0911201400b26820b022008a700da360258b03098b848108749c3208598b68559464c84280acc88280a08064aa82509339063160ad9a6685c362cdc402d141720090606cc4652cc4006424605cba288230002d10489d436302284688c262e0897611ab26103c89180864419c8649b020d6388800ba969db2045c9b28d103786012312e1085061008ad0b409da061210120212a76000394842901090906c1484210001004b4429c00866d44040d4429283462891406540165041a2858436328b2481c8c02d09970cccc808d1c86c1411100a182e193248c9c201a09840884072d3021023346ec9a41054006d53086420830c92440e21460688080d0a392201244d01936d0209710c29681b044d13b4241b2609db240513c52102124194166592c28d0b3188c1a251da168d8b388820c36840002503123212114a99962801372c8a182e63844818159041b491a3a64014214112b041d2188000970451366510b731dcb82110c20c613828d32448013389c4a02c6134000a454c50020d14270263342e42987123194811050d5a088a243471d1c62cc8a410d09641a23421093984130304604686132024141408d3160818008cd2a66019278a0a24698b362991b049219551e1a24c13c6855a18908bb851988210c4222ddc96450947210239928b9468131051d42601599841e2b85161988023976560480e183266a092494cc005d4246a08a424d438641b092584a65059c4859ab2208434221a882860146c9c366084167160128120c3315b08221a018812a2259c842d5bb06158c225d9a650ca082184a24008a58452420c99964cc924844a002d03096aa4046c908650943682d818659b140a0b208aa088000bc565122986d8944dd98844138681c418641934248192814c461014354d8c9830c4020e08425123090898a26ca328320936060b437140408c53448ee4486a08050824212ec140018b848c83a444e4805090308ee4b64921b3059444841a39725c323020b70dd916925b08044a8650020790244301e332851383880a3090d1120918021053946d122360cbb4010897250b1108938445d336722144089318228b0428d210280aa24018952193a82d03c08960c420d1248011a35101132ecb8009848405c886088308400c396421072d1a3765e4a6050c4705e2b82c50c861908025db206da2083203862d94142e00274c9420299804888b82508c24881044806120228216041a26619b223160288ad18430e126912043800095511a92889bc001a2120209a3052382099414719aa82021276c00020603116d9a346c5932866304091c398ddc2250c29044a39004e4c681cba681d4a04d522212cb0440a128091c318818379009b3505a127001964c434231e0044508168a00c84c18252524488e84c22d0a166e64b880a3c64953408e19810d43826d18458e229389ca204819454ad4824188b06d4c16640904625b809119976504b820d3a408224505e4c22d830420ccc88900388aca9871d9380a009448c9142ae184802003680238691bb80804438813c58009256d09c88dc2922c0ac245194101241730dc148c034371cb2408048891012244c9143280162601c431a044485a100441266523256142082e630249531232db146e93246e401630808621d338924c308921b5016382412283500ab88ce3040c371b6f07e5b71ef8356cbef9286af47fe05e852c2377c949b79484f87aa26a3c319d63c596a97e24c97663de07a819eb3dc79db5bffd2cf90da2d0351440bb2a0f1ffd23ac76e278b3c06b12901ef68b02d7f97b4f1604ea6269cdb934407b90f0f5d6358f05b37ab23696670b11464280509ddb4df4bc1fd5bccf536fe1ab908f39757994937d6aeb5596c45498813de84ef97f548c1dcf7144d0cdc455b08bf0d89ce32a59b12e81adc07e3cc22416778898f505b4bd0131d2ac7e01fe4e17eabfd4fe60523417db7c9207dcd43910a61e867133961484043bbd8374de9b07f38d5663a73e5e8d24ca1ae75dc304f7dc9629c1f7dbc819ce0cd93e3dc4ca62094dd51361e88533821bfaa77cd1b55049b373402918e4546b30918e150673ff833c64cfef2c58ebeeadc7d70d1524cbe71e02637562da42471551a22f7974b33a2ce80c385c3cc2ecae057a27f08e1c0298f8075ec1307bdb837d070dfea579a36022b3a809767271f2a2ee193989bc7e4375de3258c8a2ac84cc23b976751b3bc8b0e021b44df73d1908724726f215e021f8702fa60a204c636b4615fca78dfdba2767b52e30a8f5a6601fc5c4eae7ea2d1ceb705a2ce4a8f73d547abc2cd40fde20c152ae7c91c1230dd4057de4ed445c7f92af2153e1f78339f7e8b4ec953c45b164f26b46cac4d8bac7a1209785512dd9d3a4b4ab3d0b209eda7a081b6de0e43744244d10a1581245a0434c445bf111df890b2e3b4dfd4b313c46185c2c05b4ce7807471e9e33456abe7714f91cb9f7d73b13e4102bc97c62626d70fc53e2d9d9a8d1acf78549b18f65741fa132558ffb94405bc8934fb7b4c42193df9571d7f8f97fa86ee63cb515d45309cfbca0f7305be5f2a32aab74e7a7764a8bccd793bdd703cf5391d795d58d854c5bd5a6a4b3d164b2825d9c714c4c89552c5cf099d3d408bcfe74b74510f3a37029dbf87d863e4bdb8a782855d511526daf65d8c1a98c47fd99aea610e2fae1004c8c3263ceb29a968b9a5b246b94d6773415f96435859c7801df06b24a918d1e044ddfe38870c25bc7f4d4a61a5209ec2948ceb8f605fdb757d56d67441bcbab9b8091479a292925900cf8ec9f970987fecc7252ff889d04275eef9f54b4e3b72351bc7d1a41389db726c7235b955519930c22a5c99aab5431ef5f4f01f3b7c3cc78428610a26a1baed1123637a758c23d1f6654d87a655040577a16867c30a7da05b662c173b7f3c994a186f943446d89195a6797aaeb180abd5221c55533856bc92b9a6d1f382c4fbdf77b36d4bc26cd2106b6ce33451ddb7def9c235bae0b6bde13af9b05015cb9e6b605eda19a384222600ca8313c548c1383c7e30a607ca71e2870f4486f1d1987af632835edb055c59b84bd0848f2d6c97edacf4cd0eef76b89a48799354b8c15da8997b96a0b2d0f72a179f35d3560b012187da149e2110aeb548ee598fa5144c10683695e6d3564aad46ed88de5e9441cd15ca692d83ecc14242730b14bd2ca3a31cfbca6fb184ae165a48f527e2d4858c49ae0c018724ca49b52671ded5c93b2832d90351facf33a2f5c99325a62e4fd6c97321b07ccd3a6bb140c3e264b94292910b681c058836c7e8e60c570afd3c84eea41c6c76d3ea221c3ea5ed750ce70785f8795273edf7781f6f0ad450f170fea3c6cc2d0e7b4a5e825a4f4fb94dca3eb4b5392c870ac5aaf569391e654a52d2780b37668acf3870aa9040cdd57baee14df930b942643b0ec362875c5162466e3151d6e7eae759c4773be212f81579c463b51409df2b6790f4167ae46d82978982b52de58643f500a4567b6c8c82a50df8968809b2e3e3ad89233141ae014fa31597b6c54b0d9a82b2319108440c0bd9b85268fe14db4a00db15c8e24a3087863eaac98fb1c949ef4839d515ed4dd418ec4087e82a1b8bdbbdb286d09e16d04d12fdcc2cca4a40e9e320e729f29d4099ed88bbaeb80b5fbd141df323735e281ac104be541e21ea04d4efbaa24578bdc7f7dc9e7210df14efc79925ca631ec19c46a6c93bb6e1c565304a4ac055cfd8cd1fcdc65295a59f339510337b49619a54a0b3c7b4de7c6259891e3c444e3aa78aef5aa97392429827ccf40a2f34011e54faae2a066c5e4449948fe85b60e0bb2eb19b1b78a4d9f65d1d54f53b99a82eaaef195563bf7e05b38db7d41b38279cc525836b84214b91ebc3e17653e99b4470686f8bdfec12044ef3158c02fbf01aad0968ca715164646d1f25bbb00f57696d973cfd7185c0d5ea453ef88ef6eca42e7b7baa04515f2faebf488b5977ced64a9055bf2adfe46fff37ea7b376649d2f350dd75b619f36a12ccdb4b60036c0ef53f5e9e0616ff348c35a0e2170115cc8b71e94d31aa006cb9d1ed81edd118a0d813bb76df36398a0d112685780dd6c7a5325d6d4c67cb7114d372470b9c810a482bdc55cb275a45a514afa0c4a41d6b6393d61bf28ea66cb17c8fb4de5b7cfb56b1c8aad72654d519c8aaea675efe7c8d98e84e3ac936297f6c747182427876feb71865611b73459e0bc2ca1436980338cdc491756b5810ec194880f0ec9145cdd38310bad545d3998d84cd9523bc913ad410f369af1eb5b92824503ed6249048be6deaa7d5f44ea63df15290c322c4e86e76538e6cf965a25d2630283278329f673c8ebb19f62b97ab40fec7cee564b650e0cc255d528eea53706a245c98c530dced4493e4eeb4684b0881cbeff26b337c81e443be179085613b27e4d73456b61d899c60c848d9b5fb1a2f1a7125e7d3ef11f28e8aa8ec4673543af2bf4963507c5ec23627c2560e6a1be3668273cdc78bdfd7d4fb11adce565719d097ab9fc2d921e94673ce2f5859ec877e33b8535487218c63ade379e5c9ba1be1b92e4158ed7ec82b74c60a2cc7c4cb2c77eddfe8d2ccde1789b71723ab869d901c7c258fd5ff3a0cddb8378d85281f6fabc0cf1ddc8ed6c14622cafd9833d7a08659697796725f4aa27a7b767c0aa4172107311fdc9b9d57889a55e537f2e2a4af3240a3456a24475926aa305cb97ce73c0ac7a022c1dd21f0d9e32d0c38a2a5d74e2cee92aa2d290f81e5307916d6caf40c5620ea3670c2e2146ca3b2dd09a13a440a6d7febf5a89b018170e4bf2e8b36181cb67857b1013dc4eb59d757cc035a1f55703f28c3ecd9fe8c4ca4dbcbaee17462f6b940a0544fbb43e6fb1b19620d5e0aa84009cbe378e2eb8a4f7efbb55e1d47bddd11e49812b6574eb42e9d60fd2a97e7f7d77468ce8a923672b219b0546214cbe3eb5346f62526797b4d6bfb8878b53b18126a5fdc77ce07c8c529c83321d71f6dde838d93dc10d75a0210789166213191faf1897b80a5adb8cef9a68be4000029ca20ed5465d6193f7ccaebe7fa0777f4e1ae75f2662bbea0744b09d7e9d96544cde184caa940d303d1b4f50f10741b890983629c5498027c6858d2df3e936a9a6bed6e40237ce2bf90fe4d2de36639cbf0956c0de7748838b4f2f5fd99a47b4f2ee7570325bca5f58e8c2771d3cb6955d4610f605a339ba7f1e552f2403b07e4a9e91625b2403edf9416e5e0f03f419a63256d8f7b1d34f5e049bccecf2684a51f3600256f0e83dd7c94b3ff0a2c2df2744b6243b7162ba17ad3c5063a32060978e7fe1cc1ee704aa0cc78117e3741048969641c3c6c416bebc0d2e71f887a61586b3a875a84f416690ed0940f7f0f325d7686c357e1c3bf09f2e95ae89f1e588415eab9d9cfa9eec89e338f9672fe565fe89ac8f782a5635030ba27d69b1f4858592f29d798c19a62502d2bb1e4ff916a4cbd1f3896cbd4202acc219de5eaa861518376c26f4792ea841c2262be8923f79e6314b50e0b949ffc8a5a627a953036ea679a0f50ee1715e60c00090a4947674e27efd421d644472f99845d62448c093baeda9a246ab13f0083da70f7118c6951706bac8e83f47bcbd13913423c2b56b2428c4efa999952568f92a4ad3f36a79d3f6e2478e3906c9be90e0170d58065fe8c3ebe2f12bb91f9b6ffe75d26cc97a467a1d50490a5bf72ad2b4a3c74354ef304ca7747917f585ddaf2716ce620af5bdfa5062ecd94cc6ab1ba1923a21819e13fe4b5563e561e16a946ab068c445adc57d75fee0406d13bb2b28d466fe9c46c367c25496ae943800f7577196a3accad10c6ac9547bf7775ce388e9806e15c534431a75d3d8b301b553ffe94feac0a26da61763bbce647fc00b439e25c5966640f3426a9eeff1128f4619f48ae7ccf0a74259efb01d294e5aacae3cc426ced3f7bf743c592cb25879ebc35d470383c13395d43076a48399c5a2c9c2f1086367c14f33bafe68cd007b3d65efde8698d3b18db270dd3321774052799754e861e9b82ed20f31dd9ac0086cb50466e6a1ccc87d9c02570ed5b1aed39fbaf1190c1696118d0ed21e15bd1aca546636985d3b65a6a1ea689bd20365ee6fda52f8bad51fd3344defd450296bfc09844bedd57399b7e6dc956fad723d4a187b09e2b3f215d50a11c7f93c594b8bff1ba94bfbea7e05c35eb9e32ab6cbee4f90299bbb88b019b5819ac0189b7e09b9365cce29b9825b42bb1a6cde57e97f921300e29b7bf7f6c0b915e91751ed1b3d5e4cb0f58b730b22e197a0853c3a82bba396b86e6ac9c0981cf3a3b4e2389310627aeef1d289cefb28bcbe0d6adb4390e288ed76b10ae7a20b';
const MESSAGE = '4d4c2d4453412d38372074657374206d65737361676520666f72207369676e696e67';
const CTX = '5a4f4e44';
const SIGNATURE =
  '3be701f504264b93ea229ec1179a6e82b15257f12ddfa312b431f0612bb8798d0aff7ac34cccf70084f03e18f7774f66d501312e72f1d82f936bbfcff8ccbd394b0ec97c339535d3cc02d2d0883a50014a48bc6987bcac563178fd7f56478f72363926b4ae2ff03e1e1c73797b4e0276ace553d39fc6658e395e0f6526b91e0453d4705c18305b264568f10b6b3378343059232c393865f4f6d168eb767419eb91da75717ef7e11a52c61d7387ef12081b2c50f491e25576fa19af8fd23ed1327a74c0b942fa8015dedfeef072006da33576a28ac40692fdb668a33f070e0b3d516b94799f0a0d7d1d27be1ba5c1b5eb394c323d2e2976d6866ca85240410a4cbe28062dfc11f3d22640870202f76fbba145d98cb3bbc356e414f00d3b965cda31c4b3aba939c2eb629ca6dfb3e9c429591feec2193ebc94e0447bb3df2499789bb0231cbf5729ba33ab58a2726f8b51aa5e35a88c683911ba6a3df8019370ee03c09d1fc5bb74d2a64e5272bb64ba26cac9c898b8a381f1acf781734511f755466aefa8e4db05164af440ecc1f8aa340e6acdcd894c94cc2cc76a45fb16eba115d5dc0505bcebbab5578dcf220ff4afacdcb0999413240857201359feeafe8bbe2e20b14dcdecd551685ecf6a45f716de2667d2db2c2564704fcd5d514f22f7971e297948224139460f0a6dd1b25a1da9cd3cfd21d722ede6db96f88c66af837a9d0ece1f2b3f854a85b1141453c3609904b68bb9dd6190af5d1e21e3c6d315ee1185c886aa59f6328b27f4e19d74c95b59988889ffa186bf976f3f60c99466fb5cc8231399b94fc3970da9b2be81af34c046b0d562276138ee3c7ddc0ef07567259c47c89f80e1f29f9679a5aff721b79c665d74395959ee37072bd31d75c482f62b0e1313f9121555e3807cc69f7692acfc2958765dc618561733a709e3218c797f3242c1ceddf9cd394ef80c4e4cb8765db6352d2d8fa62af7043b6f1995bf72887b793f25adf0674a8a95a285ca87e5cbfc2e9834513d9f48822b7e7c4d70ca878d267851be95f66bb9ad19a02a8061bf300cbf9b9bc9a4745d3f212ed0486028f2990008bad005155af6589bd0dabe9e1ae8cdf65e9d6fc8e0032739b444fa7ac4aa063d5be36b115a9c262a48cd17379131944b0e3254572cd3350d915004aafa8f46626a037d4222995a4c2ca2dd0e566176f80d72f2000c8fb4b34d2585433f04f9e51b1d62f3c5438c18793da0521386b78282b123bbe7852034cc168266f7efcc222c7c6caf0d43618be06465948eb3f7c4068e92c7583850303bdf439b7155a60ca6d4b4892655d8b6bcefbfbcec07ab1d69055613a2a0ac7f5867b1083b56a0338efa128f2d404b531e86c03a54e81f3ee89aaa519fb3812bef398b24c8e98c4014e70a233fc88a33a2341b97e656c755e9436dcabe3691463b5fd2724b4c8d7a18a6938c74570f7b3091511f0271c03d35975612f910c71be84aa4718a5d2bfefad3d95d064701369f103e0b91e6174a83f78d7a2ef7d32f5cef60d2f2a7dbbc0eb1e72566c9cd68b12d86a00f0fa4362ecd753ed2a55f84b31aaa0b716ad8d2985a424a80cfde5f1d8790db86ad24dfb982c730b38b6ded3d34c8c55aaa787d6283beae7e93d7184a7f606d810745c3c7fd75079f78dc464a6edfce293608ccdfde1da0213339466f37f5051ba1417f55e1881d3bd622afdc2b2d3d27e3bbcaf5c2752b24f6aa271b2c2c3a19ae8a7aa7e2b8a3ac40c29931949487dd3917fbe743e08d37a375b7c0a2cf902ccee607092ee67fb2e70de9f38f49893df2d565884e02c0e59e720c1d481a178ed990f93556f6e6c6ce7ccac2c0d34a2cf295e200fe420bdb40f999c799e3beae387d7c6586a909324ba5b69d52a3d47430548e7318e013d68fe08194af1cbfcb61fabd30041c729585fd0fe995a38cac5a3142196f1212b9c4035f289d60632d43645fdfb2bafcf273bcab9bc9a6fd8c694feba54b8b25260b16dc0e1bc6aae72bf3604ccd526bfd5f68b6c26f74c6207232e6f73308b89fd431d5a5b40c396b0271592acee81eac728707f29a3424ba6ca394594268ddf634cfabed5d0c2cc46f15703c2826b4a59c0c23e63b9150903f00ec53d853d7f11faace87e6bf5f1c329889ab548668f964c20663f7e46fd96c2e6d0b52d2a85a1c193b21fedab5aa24887385745f6f9fa5d886d29701d6f5f81ea3998334440e9dc86b6b680513d562a0146e232cdb306840229ee029086b325aba81ee8c1f4c1dc09d35a853805a434295b71e5ec220f2d7255ea16da789b0573362c3dd12315e0ecf84a5e5f7f73a9d8ce47b3c510c52f7a35bb5135598c15f23da20b234a648f73891ebab3f1e5faf177470a80d58ab5c546350ee6d97cac210a98a286be9bf028c085023729da8b91c23a91408cda7c003e0b11e97a26b31503ff03b59577b2082cffd98c8c6b20870ff7c76014a29a8d0b991448570c6d29958e08d93ff636522018da5f709e8de0bdd7aab278e3f795c8a115c92befeabb1681e7f0f5593a2f88fbaba49667b3acff8772f08c0cecce71f348c7fbc9c3ddc5b408e1e9f79549406c13c4fabd8b645953b393e8f4b8370598f3b272a19f37da4442e83b39c88fdc6bb8c9df0c0eb47fef920830f6659d7e603f62391606076182fc0271f98ec29c178dda610dc92fe35e2510b7eebd0933eef991d902a72e6ce88e10efb1ac575852869b204b9773f6d1eaa492cefaf910531f5970ad0db69d8c064ebde401b8477d6081b9edb914709573984393da32d40b159655e07c3333f108996ba032c4ec8661ecd53d0a1b6d125308c1ede849b810e94fae380c50ee26ccb5f88939529008f3253e7ebd984f99aba2f2a749e617cf64eea03548291701e45ce7357fe8dbf91154dc2c4f8a17759b2c05c87e16d4ee4ec56a9d116e95b84ec3a01dab692fc52b1c56658ecb153008268df898fbbeb98bcba5e91380f078a2171c9ea86e5cca79b996d563acdd4eac81f10c196a4deaa499ed2b8205713a9522381c1f751a579dc1ec7a458c3756a67c719253a83c21753361b9408a3d8bd58b96d25d78b99350537a43804f81bd46f3da8ee7479f87ee0d611e3dc8aa2b651edccd83eff9a5e74d4413e8f274dca5388e9ff5a6d6aabeaf1901aa14f69d96c1672f61d313f59020908e8863ef23b41cacc444a7595adea00975e3e3f7fc9219093ec3acf88efc59fcde079fdcc3345819594ff93098a53c6e25b72cc78f0faa1f28b04cdd0103e1aa80a03726f6b4c0a5755dfdf4040b4c8e952350db1de23b6ade29a8c2e58b7e10c82a7875afce516989b458a43dc888183264031a9a86d29b015ed39b1ca2f0a705b877619b787bdff85422e587834b160a7e35146f7baa3fd0723afaa179d79a008c6afbe445255c3b1f729808adbb8e69f06691262945fba7ec026afcbdc12e4fb4388f88804ab1aa9745c97cc886ba71ef2a85f6d62d5c50d80dd89627c1a46fce42455b5bfa5c439abb7c97e5826954245e9d9390913d183365df3019affc5a9164cd4058ea171c8c86913534fff330c2941f7bc0718884a84c55a3a726d9334ca5514b02c597fe2061426280a08a2ae22ad693cee708707d23aebf3b9927f87f76c0f6aa4c5c10b6bd1b738825904d86bbe95a894d0af5fa963abf9acd3dc28c09a1ffec0eea1cec3aa0bfdd4e5cbd0ea4658f10b4f45e12c02f836c3f6ddacbd96d5713bd226dce3b84925d60b4d6cbf3cedbbbe61b8250749c2888ab75624b0d66fbb4c5d4b674ea75290630a06b404f1a3f9d556ea3581ee954b0720d1a2720c955eeedceaff5e595c3e0d9ad157eab1a591f01d705816fa8d0ab08f2e739b66a9c4f35988808a09de4f7ce3ae757e83126cca2e5d73dc0249d1073e53fce24833743e722f55275f5e796f48605b7724839249ca41fe35d3da90f570a0f957da4ed9dd25b697c313843cea1792c3fc8f96bb24cde438e8ff15580771ba7de7557f7946f776ad042e6c4dec9fc93a99078726ae782d8a1c85140ae7ceec46551e4a408f6cfa1ea09c0807eff0d192272faf91d8b47436d9091755140da09fccd33218a5e3ce16818f2a36b6b4f563112d3edec6cadcae7f88fbdd1c260122e93b2b9da595d1bc7b6df954ab99eb44de14d91333590fde756fa255581db1105720691fecad50a7a438b7d25cad5cabdfcee77f816de76bfbf54c186924020260341a2e43f7cf0a14f06b7a08c92f5753e8239fd505d59033f648aee8a5a94fd9777e5be9ce77a66417c79cae27919ea205005589ab37170df4e37079eea187e9a5fcdcd44d5f72f9fe4498906ef04d85cd6f8d0c36cb65d30afb6fb495ef7559c90135cd9304f49362e6b0d8678b5a7eb72944a65fc28c844814a742707dc729361227aead38184b425c26c9f8c9a7b1d12ad00d231302f3d6fccf337dc31d2f7ff4a698fef4b55bbe1f59230dc6902869d6268164ed12faf3795a52e5e22f55e16b290e8731546b2d686cebfa32d9e4494b02e2fa437cf02bd613fc4cd7c1601799c7a95d41b4880ebf3ce001f4492eff12cda040e53ef4e95b1222d289a2c60ec90258cafb7f401f32de4390b46282f9bba35e51eb21fbad44ba8f807fcccfced9546327912dc52313227608bbc1a948b4188c501e05d12eb1cb9628ce9199c4009a9314ef777157da03bd902d88cc3c7f9442bc0712df5c9918601c5007e4dbb45ef2751d30b96795bc8c64c04dafe08559e96199906a55e96f04d844cf4769ee551802e27bb1d9bba82f99fef6eb9769bea0c641dd961743b729150915b54296777cd46ef6a50b8917e2655a19175cf74df28df6e3159c0a7dc2b709b4d3e53b0ebb30816172a10aa0d04089ac639401e89c58ca399b1081ebc1dbde0f69a44724374b0a34592123b5329b520856ef420dc4ad1d158bab469825ce5ec903cb4c899ad5f7714d0d030a261588ac9e2e30ba79d9e5d62b6e07990b753783de4693eb55357882538c7ccb5695098dc65ef55f4fbeead5d8108a62d0aa49c51a538641e2eba8c8e97f0000d526bc52a77f6f22d86ac9eca2ee97ded2d6a06e5f240474131afd674b9052ea95751278bfc4e6d020ed490c1ec9a587a8ebd31dd19d36612fba50d5d1d6e35f1ed2dbb45069dedcedadca12f917642658e6f69ae9a6de1686b80094e724629b93f9feb6cbd65c1099eb63582b80d5a6d9d26466dee5c09aea183098b5011401af63a46fce991f72e469e3e5798c99d18c6ce1211d2cc53807669815494e57f81a21250cf0676ca9d63b15d317f22e487abe4918e7302a8eee876cdf8411618545bf2d4851b394663c418b6a05658a469f89dc8268cbc9696bc6ed92ba01ccff30f9752792f41f323676442ab00d2bdc1b968aa67ba3e9d8ad1745844bedd737cf42f428e896d26e235d09736548b135b3f0d4811db639108c06c5127be8ab9b2ddd4e882a1ee240be08aff1fe293b010afeb02e58c8fffc97c9a06473257eb460aec5ffe95820004c25da81cf2a304e498eb0d58c60b5ea257ef51d2b06e6d8302202bc826e7ee5cf6a9428435a8fe2ee84301297b41ceaff5cc629c16bf8d63dd9a64d054d4a36cc592c93e62a4d384e0cd3b5167dff6b468ae0039e353858c20fe5f0bb64c7447871a36b7e8c50ffc2c04cf6496a7e4f0e138716538f23f77433f54944fda8bff6fbddee9391fc0a19276cf474afe66cc933084ed99ab5d0888e215f3558bececdd70be37cdcf2d3a61cf26521ff301e5044a2bcbd8853be260bf4881bd6c3a67d4f1532fc9bc1b35f4fe7e5d3d0f80675b8e370a18f4b9e656eb7ff288645c1a18b31f3cac9fa344556cff78ac615a4bb6944b7974c415ae796d180fa479c45b017973a5cf8741f3a65472993db60fa30c517395dae296762416173f9e62de543488eb891560be885e9b6125e21630a4b955b4192e04d120a21b77008316c5c58c7a411a73fd87d5101800b8b10ce50f67df849f1339ffd9503ac2b5da40d63287320c36296fc6d4a626ccf803b6b356faf73a3ad54a4d82f20a4fa0c5c6302723e7f5e330b9bb218eb80e10fe75c6569820fcf8b781a19cb4646f66f4feb11db11cf5d3b114b55d9093a8504dc8cde4bcf259cefe2b5d6d5f91ae5a7fec173541d751492ad7d11797986c87dcdb1b74b205777d861eff072670a68c6856bb6edaacb9503fa97471c54a7128a826ba82f9ec7df0ae4ddb88adf88559395deea942a233b848dd56bd6e9d34f246012a9515632bd63282aa2772f4881781bc353a59e06aa5accad4616878a7bba8014755386521e7eec2d467aaa21b40a0304343b8d90d12d39d478a2eba5e24df7c11f055bf46a182c576b034c7924f069f1a0723785d37b1fe4d41e209bd9b3ca255fe8a72eafc450511f457b85b7dbf8db011329406db9dee5f8fb1f88919bb0526db6c6cfd5daf8fb5e758492a60883c5d80016243244a6daf000000000000000000000000000000000000000000000000000000708121720252931';

// describe('cryptoSignKeypair', () => {
//   it('should generate the expected pk and sk', () => {
//     const pk = new Uint8Array(CryptoPublicKeyBytes);
//     const sk = new Uint8Array(CryptoSecretKeyBytes);

//     cryptoSignKeypair(Buffer.from(HASHEDSEED, 'hex'), pk, sk);
//     expect(Buffer.from(pk, 'binary').toString('hex')).to.equal(PK);
//     expect(Buffer.from(sk, 'binary').toString('hex')).to.equal(SK);
//   });
// });

// describe('cryptoSignKeypair with null seed generates pk/sk', () => {
//   it('should generate the expected pk and sk', () => {
//     const pk = new Uint8Array(CryptoPublicKeyBytes);
//     const sk = new Uint8Array(CryptoSecretKeyBytes);
//     cryptoSignKeypair(null, pk, sk);
//     expect(pk.length).to.equal(CryptoPublicKeyBytes);
//     expect(sk.length).to.equal(CryptoSecretKeyBytes);
//   });
// });

describe('cryptoSign', () => {
  it('should return the expected signature message', () => {
    const msg = Buffer.from(MESSAGE, 'hex');
    const sk = Buffer.from(SK, 'hex');
    const ctx = Buffer.from(CTX, 'hex');

    const sigMessage = cryptoSign(msg, sk, false, ctx);

    expect(Buffer.from(sigMessage, 'binary').toString('hex')).to.equal(SIGNATURE + MESSAGE);
  });
});

// describe('cryptoSignOpen', () => {
//   it('should return the expected message', () => {
//     const sigMessage = Buffer.from(SIGNATURE + MESSAGE, 'hex');
//     const pk = Buffer.from(PK, 'hex');

//     const openedMessage = cryptoSignOpen(sigMessage, pk);
//     expect(Buffer.from(openedMessage, 'binary').toString('hex')).to.equal(MESSAGE);
//   });
// });

// describe('cryptoSignVerify', () => {
//   it('should return true', () => {
//     const sig = Buffer.from(SIGNATURE, 'hex');
//     const msg = Buffer.from(MESSAGE, 'hex');
//     const pk = Buffer.from(PK, 'hex');

//     expect(cryptoSignVerify(sig, msg, pk)).to.equal(true);
//   });
// });

// describe('cryptoSignSignature', () => {
//   it('should throw on invalid sk length', () => {
//     const sk = Buffer.from('00', 'hex');
//     const msg = Buffer.from(MESSAGE, 'hex');
//     const sig = Buffer.alloc(CryptoBytes);

//     expect(() => {
//       cryptoSignSignature(sig, msg, sk, false);
//     }).to.throw('invalid sk length');
//   });
// });

// TODO(rgeraldes24)
// describe('signingErrors', () => {
//   it('should throw an error if the pk or sk is null', () => {
//     const pkBad = null;
//     const skBad = null;
//     const pk = new Uint8Array(CryptoPublicKeyBytes);
//     const sk = new Uint8Array(CryptoSecretKeyBytes);
//     expect(() => {
//       cryptoSignKeypair(Buffer.from(HASHEDSEED, 'hex'), pkBad, sk);
//     }).to.throw('pk/sk cannot be null');
//     expect(() => {
//       cryptoSignKeypair(Buffer.from(HASHEDSEED, 'hex'), pk, skBad);
//     }).to.throw('pk/sk cannot be null');
//     expect(() => {
//       cryptoSignKeypair(Buffer.from(HASHEDSEED, 'hex'), pkBad, skBad);
//     }).to.throw('pk/sk cannot be null');
//   });
//   it('should throw an error if the pk or sk had an invalid length', () => {
//     const pkBad = new Uint8Array(12);
//     const skBad = new Uint8Array(12);
//     const pk = new Uint8Array(CryptoPublicKeyBytes);
//     const sk = new Uint8Array(CryptoSecretKeyBytes);
//     expect(() => {
//       cryptoSignKeypair(Buffer.from(HASHEDSEED, 'hex'), pkBad, sk);
//     }).to.throw('invalid pk length 12');
//     expect(() => {
//       cryptoSignKeypair(Buffer.from(HASHEDSEED, 'hex'), pk, skBad);
//     }).to.throw('invalid sk length 12');
//     expect(() => {
//       cryptoSignKeypair(Buffer.from(HASHEDSEED, 'hex'), pkBad, skBad);
//     }).to.throw('invalid pk length 12');
//   });
// });
